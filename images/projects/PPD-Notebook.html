<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>PPD-Notebook</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>

  <!-- Custom stylesheet, it must be in the same directory as the html file -->
  <link rel="stylesheet" href="custom.css">

  <!-- Load mathjax -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML-full,Safe"> </script>
  <!-- MathJax configuration -->
  <script type="text/x-mathjax-config">
    init_mathjax = function() {
        if (window.MathJax) {
        // MathJax loaded
            MathJax.Hub.Config({
                TeX: {
                    equationNumbers: {
                    autoNumber: "AMS",
                    useLabelIds: true
                    }
                },
                tex2jax: {
                    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                    processEscapes: true,
                    processEnvironments: true
                },
                displayAlign: 'center',
                CommonHTML: {
                    linebreaks: {
                    automatic: true
                    }
                }
            });

            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        }
    }
    init_mathjax();
    </script>
  <!-- End of mathjax configuration -->
</head>

<body class="jp-Notebook" data-jp-theme-light="true" data-jp-theme-name="JupyterLab Light">
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[1]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="o">--</span> <span class="n">check</span> <span class="n">the</span> <span class="n">total</span> <span class="n">rows</span> <span class="ow">in</span> <span class="n">data</span> <span class="n">table</span>
<span class="n">SELECT</span> <span class="n">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">public_pensions</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child">

          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



          <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
            (1 row(s) affected)
          </div>

        </div>
        <div class="jp-OutputArea-child">

          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



          <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
            Total execution time: 00:00:00.978
          </div>

        </div>
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[1]:</div>



          <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult"
            data-mime-type="text/html">
            <table>
              <tr>
                <th>count</th>
              </tr>
              <tr>
                <td>6071</td>
              </tr>
            </table>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h1 id="Public-Pension-Plans-Project">Public Pension Plans Project<a class="anchor-link"
              href="#Public-Pension-Plans-Project">&#182;</a></h1>
          <h2 id="Identify-Key-Metrics-in-pension-financials">Identify Key Metrics in pension financials<a
              class="anchor-link" href="#Identify-Key-Metrics-in-pension-financials">&#182;</a></h2>
          <h3 id="KPI-List-items-to-query-from-SQL-Database:">KPI List items to query from SQL Database:<a
              class="anchor-link" href="#KPI-List-items-to-query-from-SQL-Database:">&#182;</a></h3>
          <ul>
            <li>(Panel) FundamentalsÂ - 5yr</li>
            <li>(Panel) Member Count</li>
            <li>(Panel) Inflows / outflows - 3yr</li>
            <li>(Panel) Asset Allocation Mix</li>
            <li>(Panel) Investment Income - 10yr</li>
          </ul>

        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[4]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="o">--</span> <span class="p">(</span><span class="n">Panel</span><span class="p">)</span> <span class="n">Fundamentals</span>

<span class="n">SELECT</span> <span class="n">ppd_id</span><span class="p">,</span> <span class="s2">&quot;PlanName&quot;</span><span class="p">,</span> <span class="s2">&quot;PlanClosed&quot;</span><span class="p">,</span>
<span class="n">cast</span><span class="p">(</span><span class="n">fy</span> <span class="k">as</span> <span class="nb">int</span><span class="p">),</span> 
<span class="n">cast</span><span class="p">(</span><span class="s2">&quot;ActAssets_GASB&quot;</span> <span class="o">*</span> <span class="mi">1000</span> <span class="k">as</span> <span class="n">bigint</span><span class="p">)</span> <span class="k">as</span> <span class="s2">&quot;ActAssets_GASB&quot;</span><span class="p">,</span> 
<span class="n">cast</span><span class="p">(</span><span class="s2">&quot;UAAL_GASB&quot;</span> <span class="o">*</span> <span class="mi">1000</span> <span class="k">as</span> <span class="n">bigint</span><span class="p">)</span> <span class="k">as</span> <span class="s2">&quot;UAAL_GASB&quot;</span><span class="p">,</span>
<span class="n">cast</span><span class="p">(</span><span class="s2">&quot;TotFund_BnchmrkRtrn&quot;</span> <span class="o">/</span> <span class="mi">100</span> <span class="k">as</span> <span class="n">real</span><span class="p">)</span> <span class="k">as</span> <span class="s2">&quot;TotFund_BnchmrkRtrn&quot;</span><span class="p">,</span> 
<span class="s2">&quot;InvestmentReturn_1yr&quot;</span><span class="p">,</span> 
<span class="n">cast</span><span class="p">(</span><span class="s2">&quot;FairValueChange_tot&quot;</span> <span class="o">*</span> <span class="mi">1000</span> <span class="k">as</span> <span class="n">bigint</span><span class="p">)</span> <span class="k">as</span> <span class="s2">&quot;FairValueChange_tot&quot;</span>
<span class="n">FROM</span> <span class="n">public_pensions</span>
<span class="n">WHERE</span> <span class="s2">&quot;PlanClosed&quot;</span> <span class="o">=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">fy</span> <span class="o">&lt;=</span><span class="mi">2022</span> <span class="ow">and</span> <span class="n">fy</span> <span class="o">&gt;=</span> <span class="mi">2018</span> <span class="ow">and</span> <span class="n">ppd_id</span> <span class="o">!=</span> <span class="mi">186</span>
<span class="n">ORDER</span> <span class="n">BY</span> <span class="n">ppd_id</span><span class="p">,</span> <span class="n">fy</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child">

          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



          <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
            (1010 row(s) affected)
          </div>

        </div>
        <div class="jp-OutputArea-child">

          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



          <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
            Displaying Top 10 rows.
          </div>

        </div>
        <div class="jp-OutputArea-child">

          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



          <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
            Total execution time: 00:00:00.096
          </div>

        </div>
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[4]:</div>



          <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult"
            data-mime-type="text/html">
            <table>
              <tr>
                <th>ppd_id</th>
                <th>PlanName</th>
                <th>PlanClosed</th>
                <th>fy</th>
                <th>ActAssets_GASB</th>
                <th>UAAL_GASB</th>
                <th>TotFund_BnchmrkRtrn</th>
                <th>InvestmentReturn_1yr</th>
                <th>FairValueChange_tot</th>
              </tr>
              <tr>
                <td>1</td>
                <td>Alabama ERS</td>
                <td>0.0</td>
                <td>2018</td>
                <td>12240597000</td>
                <td>5589138000</td>
                <td>0.1155</td>
                <td>0.0929</td>
                <td>775132000</td>
              </tr>
              <tr>
                <td>1</td>
                <td>Alabama ERS</td>
                <td>0.0</td>
                <td>2019</td>
                <td>12645789000</td>
                <td>5897753000</td>
                <td>0.0293</td>
                <td>0.0278</td>
                <td>30092000</td>
              </tr>
              <tr>
                <td>1</td>
                <td>Alabama ERS</td>
                <td>0.0</td>
                <td>2020</td>
                <td>13491176000</td>
                <td>6295296000</td>
                <td>0.0853</td>
                <td>0.0583</td>
                <td>425632000</td>
              </tr>
              <tr>
                <td>1</td>
                <td>Alabama ERS</td>
                <td>0.0</td>
                <td>2021</td>
                <td>14291093000</td>
                <td>6813849000</td>
                <td>0.24</td>
                <td>0.2218</td>
                <td>2558276000</td>
              </tr>
              <tr>
                <td>1</td>
                <td>Alabama ERS</td>
                <td>0.0</td>
                <td>2022</td>
                <td>14291093000</td>
                <td>6813849000</td>
                <td>-0.1332</td>
                <td>-0.1302</td>
                <td>-2274633000</td>
              </tr>
              <tr>
                <td>2</td>
                <td>Alabama Teachers</td>
                <td>0.0</td>
                <td>2018</td>
                <td>25006420000</td>
                <td>10621979000</td>
                <td>0.1112</td>
                <td>0.0942</td>
                <td>1615440000</td>
              </tr>
              <tr>
                <td>2</td>
                <td>Alabama Teachers</td>
                <td>0.0</td>
                <td>2019</td>
                <td>25821326000</td>
                <td>11394144000</td>
                <td>0.026</td>
                <td>0.0263</td>
                <td>33671000</td>
              </tr>
              <tr>
                <td>2</td>
                <td>Alabama Teachers</td>
                <td>0.0</td>
                <td>2020</td>
                <td>26681234000</td>
                <td>11071566000</td>
                <td>0.082</td>
                <td>0.0562</td>
                <td>801465000</td>
              </tr>
              <tr>
                <td>2</td>
                <td>Alabama Teachers</td>
                <td>0.0</td>
                <td>2021</td>
                <td>28154228000</td>
                <td>11952577000</td>
                <td>0.2395</td>
                <td>0.2262</td>
                <td>5155012000</td>
              </tr>
              <tr>
                <td>2</td>
                <td>Alabama Teachers</td>
                <td>0.0</td>
                <td>2022</td>
                <td>28154228000</td>
                <td>11952577000</td>
                <td>NULL</td>
                <td>-0.1318</td>
                <td>-4500179000</td>
              </tr>
            </table>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[7]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="o">--</span> <span class="p">(</span><span class="n">Panel</span><span class="p">)</span> <span class="n">Member</span> <span class="n">Count</span>

<span class="n">SELECT</span> <span class="n">ppd_id</span><span class="p">,</span> <span class="s2">&quot;PlanName&quot;</span><span class="p">,</span> <span class="s2">&quot;PlanClosed&quot;</span><span class="p">,</span>
<span class="n">cast</span><span class="p">(</span><span class="n">fy</span> <span class="k">as</span> <span class="nb">int</span><span class="p">),</span> 
<span class="n">cast</span><span class="p">(</span><span class="n">beneficiaries_tot</span> <span class="k">as</span> <span class="nb">int</span><span class="p">),</span> 
<span class="n">cast</span><span class="p">((</span><span class="s2">&quot;TotMembership&quot;</span> <span class="o">-</span> <span class="n">beneficiaries_tot</span> <span class="o">-</span> <span class="n">actives_tot</span><span class="p">)</span> <span class="k">as</span> <span class="nb">int</span><span class="p">)</span> <span class="k">as</span> <span class="n">deferred_tot</span><span class="p">,</span> 
<span class="n">cast</span><span class="p">(</span><span class="n">actives_tot</span> <span class="k">as</span> <span class="nb">int</span><span class="p">),</span>
<span class="n">cast</span><span class="p">(</span><span class="s2">&quot;TotMembership&quot;</span> <span class="k">as</span> <span class="nb">int</span><span class="p">)</span>
<span class="n">FROM</span> <span class="n">public_pensions</span>
<span class="n">WHERE</span> <span class="s2">&quot;PlanClosed&quot;</span> <span class="o">=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">fy</span> <span class="o">=</span> <span class="mi">2021</span> <span class="ow">and</span> <span class="n">ppd_id</span> <span class="o">!=</span> <span class="mi">186</span>
<span class="n">ORDER</span> <span class="n">BY</span> <span class="n">ppd_id</span><span class="p">,</span> <span class="n">fy</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child">

          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



          <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
            (16 row(s) affected)
          </div>

        </div>
        <div class="jp-OutputArea-child">

          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



          <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
            Displaying Top 10 rows.
          </div>

        </div>
        <div class="jp-OutputArea-child">

          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



          <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
            Total execution time: 00:00:00.014
          </div>

        </div>
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[7]:</div>



          <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult"
            data-mime-type="text/html">
            <table>
              <tr>
                <th>ppd_id</th>
                <th>PlanName</th>
                <th>PlanClosed</th>
                <th>fy</th>
                <th>beneficiaries_tot</th>
                <th>deferred_tot</th>
                <th>actives_tot</th>
                <th>TotMembership</th>
              </tr>
              <tr>
                <td>1</td>
                <td>Alabama ERS</td>
                <td>0.0</td>
                <td>2021</td>
                <td>55916</td>
                <td>24729</td>
                <td>84571</td>
                <td>165216</td>
              </tr>
              <tr>
                <td>1</td>
                <td>Alabama ERS</td>
                <td>0.0</td>
                <td>2022</td>
                <td>55916</td>
                <td>24729</td>
                <td>84571</td>
                <td>165216</td>
              </tr>
              <tr>
                <td>2</td>
                <td>Alabama Teachers</td>
                <td>0.0</td>
                <td>2021</td>
                <td>103071</td>
                <td>26329</td>
                <td>134034</td>
                <td>263434</td>
              </tr>
              <tr>
                <td>2</td>
                <td>Alabama Teachers</td>
                <td>0.0</td>
                <td>2022</td>
                <td>103071</td>
                <td>26329</td>
                <td>134034</td>
                <td>263434</td>
              </tr>
              <tr>
                <td>5</td>
                <td>Arizona Public Safety</td>
                <td>0.0</td>
                <td>2021</td>
                <td>16690</td>
                <td>2617</td>
                <td>18366</td>
                <td>37673</td>
              </tr>
              <tr>
                <td>5</td>
                <td>Arizona Public Safety</td>
                <td>0.0</td>
                <td>2022</td>
                <td>17435</td>
                <td>2901</td>
                <td>18185</td>
                <td>38521</td>
              </tr>
              <tr>
                <td>6</td>
                <td>Arizona SRS</td>
                <td>0.0</td>
                <td>2021</td>
                <td>162967</td>
                <td>250400</td>
                <td>207913</td>
                <td>621280</td>
              </tr>
              <tr>
                <td>6</td>
                <td>Arizona SRS</td>
                <td>0.0</td>
                <td>2022</td>
                <td>167370</td>
                <td>255622</td>
                <td>208393</td>
                <td>631385</td>
              </tr>
              <tr>
                <td>7</td>
                <td>Arkansas PERS</td>
                <td>0.0</td>
                <td>2021</td>
                <td>40762</td>
                <td>14802</td>
                <td>42669</td>
                <td>98233</td>
              </tr>
              <tr>
                <td>7</td>
                <td>Arkansas PERS</td>
                <td>0.0</td>
                <td>2022</td>
                <td>41390</td>
                <td>15066</td>
                <td>42771</td>
                <td>99227</td>
              </tr>
            </table>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[8]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="o">--</span> <span class="p">(</span><span class="n">Panel</span><span class="p">)</span> <span class="n">Inflows</span> <span class="o">/</span> <span class="n">Outflows</span>

<span class="n">SELECT</span> <span class="n">ppd_id</span><span class="p">,</span> <span class="s2">&quot;PlanName&quot;</span><span class="p">,</span> <span class="s2">&quot;PlanClosed&quot;</span><span class="p">,</span>
<span class="n">cast</span><span class="p">(</span><span class="n">fy</span> <span class="k">as</span> <span class="nb">int</span><span class="p">),</span> 
<span class="n">cast</span><span class="p">(</span><span class="s2">&quot;contrib_EE_regular&quot;</span> <span class="o">*</span> <span class="mi">1000</span> <span class="k">as</span> <span class="n">bigint</span><span class="p">)</span> <span class="k">as</span> <span class="s2">&quot;contrib_EE_regular&quot;</span><span class="p">,</span> 
<span class="n">cast</span><span class="p">(</span><span class="s2">&quot;contrib_ER_tot&quot;</span> <span class="o">*</span> <span class="mi">1000</span> <span class="k">as</span> <span class="n">bigint</span><span class="p">)</span> <span class="k">as</span> <span class="s2">&quot;contrib_ER_tot&quot;</span><span class="p">,</span> 
<span class="n">cast</span><span class="p">(</span><span class="n">contrib_tot</span> <span class="o">*</span> <span class="mi">1000</span> <span class="k">as</span> <span class="n">bigint</span><span class="p">)</span> <span class="k">as</span> <span class="s2">&quot;contrib_tot&quot;</span><span class="p">,</span>
<span class="n">cast</span><span class="p">(</span><span class="s2">&quot;FairValueChange_tot&quot;</span> <span class="o">*</span> <span class="mi">1000</span> <span class="k">as</span> <span class="n">bigint</span><span class="p">)</span> <span class="k">as</span> <span class="s2">&quot;FairValueChange_tot&quot;</span><span class="p">,</span>
<span class="n">cast</span><span class="p">(</span><span class="s2">&quot;expense_RetBenefits&quot;</span> <span class="o">*</span> <span class="mi">1000</span> <span class="k">as</span> <span class="n">bigint</span><span class="p">)</span> <span class="k">as</span> <span class="s2">&quot;expense_RetBenefits&quot;</span><span class="p">,</span>
<span class="n">cast</span><span class="p">(</span><span class="s2">&quot;expense_DeathBenefits&quot;</span> <span class="o">*</span> <span class="mi">1000</span> <span class="k">as</span> <span class="n">bigint</span><span class="p">)</span> <span class="k">as</span> <span class="s2">&quot;expense_DeathBenefits&quot;</span><span class="p">,</span> 
<span class="n">cast</span><span class="p">(</span><span class="s2">&quot;expense_DisabilityBenefits&quot;</span> <span class="o">*</span> <span class="mi">1000</span> <span class="k">as</span> <span class="n">bigint</span><span class="p">)</span> <span class="k">as</span> <span class="s2">&quot;expense_DisabilityBenefits&quot;</span><span class="p">,</span> 
<span class="n">cast</span><span class="p">(</span><span class="s2">&quot;expense_LumpSumBenefits&quot;</span> <span class="o">*</span> <span class="mi">1000</span> <span class="k">as</span> <span class="n">bigint</span><span class="p">)</span> <span class="k">as</span> <span class="s2">&quot;expense_LumpSumBenefits&quot;</span><span class="p">,</span> 
<span class="n">cast</span><span class="p">(</span><span class="s2">&quot;expense_SurvivorBenefits&quot;</span> <span class="o">*</span> <span class="mi">1000</span> <span class="k">as</span> <span class="n">bigint</span><span class="p">)</span> <span class="k">as</span> <span class="s2">&quot;expense_SurvivorBenefits&quot;</span><span class="p">,</span>
<span class="n">cast</span><span class="p">(</span><span class="n">expense_refunds</span> <span class="o">*</span> <span class="mi">1000</span> <span class="k">as</span> <span class="n">bigint</span><span class="p">)</span> <span class="k">as</span> <span class="s2">&quot;expense_refunds&quot;</span><span class="p">,</span> 
<span class="n">cast</span><span class="p">(</span><span class="s2">&quot;expense_AdminExpenses&quot;</span> <span class="o">*</span> <span class="mi">1000</span> <span class="k">as</span> <span class="n">bigint</span><span class="p">)</span> <span class="k">as</span> <span class="s2">&quot;expense_AdminExpenses&quot;</span><span class="p">,</span>
<span class="n">cast</span><span class="p">(</span><span class="n">expense_net</span> <span class="o">*</span> <span class="mi">1000</span> <span class="k">as</span> <span class="n">bigint</span><span class="p">)</span> <span class="k">as</span> <span class="s2">&quot;expense_net&quot;</span>
<span class="n">FROM</span> <span class="n">public_pensions</span>
<span class="n">WHERE</span> <span class="s2">&quot;PlanClosed&quot;</span> <span class="o">=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">fy</span> <span class="o">&lt;=</span><span class="mi">2022</span> <span class="ow">and</span> <span class="n">fy</span> <span class="o">&gt;=</span> <span class="mi">2020</span> <span class="ow">and</span> <span class="n">ppd_id</span> <span class="o">!=</span> <span class="mi">186</span>
<span class="n">ORDER</span> <span class="n">BY</span> <span class="n">ppd_id</span><span class="p">,</span> <span class="n">fy</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child">

          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



          <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
            (606 row(s) affected)
          </div>

        </div>
        <div class="jp-OutputArea-child">

          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



          <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
            Displaying Top 10 rows.
          </div>

        </div>
        <div class="jp-OutputArea-child">

          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



          <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
            Total execution time: 00:00:00.079
          </div>

        </div>
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[8]:</div>



          <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult"
            data-mime-type="text/html">
            <table>
              <tr>
                <th>ppd_id</th>
                <th>PlanName</th>
                <th>PlanClosed</th>
                <th>fy</th>
                <th>contrib_EE_regular</th>
                <th>contrib_ER_tot</th>
                <th>contrib_tot</th>
                <th>FairValueChange_tot</th>
                <th>expense_RetBenefits</th>
                <th>expense_DeathBenefits</th>
                <th>expense_DisabilityBenefits</th>
                <th>expense_LumpSumBenefits</th>
                <th>expense_SurvivorBenefits</th>
                <th>expense_refunds</th>
                <th>expense_AdminExpenses</th>
                <th>expense_net</th>
              </tr>
              <tr>
                <td>1</td>
                <td>Alabama ERS</td>
                <td>0.0</td>
                <td>2020</td>
                <td>266056000</td>
                <td>519806000</td>
                <td>1135500000</td>
                <td>425632000</td>
                <td>-1209437000</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>-13128000</td>
                <td>-1277065000</td>
              </tr>
              <tr>
                <td>1</td>
                <td>Alabama ERS</td>
                <td>0.0</td>
                <td>2021</td>
                <td>281975000</td>
                <td>516402000</td>
                <td>803049000</td>
                <td>2558276000</td>
                <td>-1260159000</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>-10977000</td>
                <td>-1335059000</td>
              </tr>
              <tr>
                <td>1</td>
                <td>Alabama ERS</td>
                <td>0.0</td>
                <td>2022</td>
                <td>303507000</td>
                <td>559869000</td>
                <td>872433000</td>
                <td>-2274633000</td>
                <td>-1323657000</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>-11306000</td>
                <td>-1407290000</td>
              </tr>
              <tr>
                <td>2</td>
                <td>Alabama Teachers</td>
                <td>0.0</td>
                <td>2020</td>
                <td>510818000</td>
                <td>862475000</td>
                <td>1378080000</td>
                <td>801465000</td>
                <td>-2328892000</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>-21957000</td>
                <td>-2425495000</td>
              </tr>
              <tr>
                <td>2</td>
                <td>Alabama Teachers</td>
                <td>0.0</td>
                <td>2021</td>
                <td>519627000</td>
                <td>874401000</td>
                <td>1400533000</td>
                <td>5155012000</td>
                <td>-2415128000</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>-20402000</td>
                <td>-2512831000</td>
              </tr>
              <tr>
                <td>2</td>
                <td>Alabama Teachers</td>
                <td>0.0</td>
                <td>2022</td>
                <td>553615000</td>
                <td>932332000</td>
                <td>1554199000</td>
                <td>-4500179000</td>
                <td>-2555391000</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>-18945000</td>
                <td>-2658331000</td>
              </tr>
              <tr>
                <td>5</td>
                <td>Arizona Public Safety</td>
                <td>0.0</td>
                <td>2020</td>
                <td>132369000</td>
                <td>953193000</td>
                <td>1096041000</td>
                <td>59646000</td>
                <td>-754809000</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>-14341000</td>
                <td>-8407000</td>
                <td>-923171000</td>
              </tr>
              <tr>
                <td>5</td>
                <td>Arizona Public Safety</td>
                <td>0.0</td>
                <td>2021</td>
                <td>136876000</td>
                <td>1928807000</td>
                <td>2075185000</td>
                <td>2227079000</td>
                <td>-804544000</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>-12762000</td>
                <td>-11004000</td>
                <td>-957987000</td>
              </tr>
              <tr>
                <td>5</td>
                <td>Arizona Public Safety</td>
                <td>0.0</td>
                <td>2022</td>
                <td>144042000</td>
                <td>3041767000</td>
                <td>3202514000</td>
                <td>-709924000</td>
                <td>-860512000</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>-14775000</td>
                <td>-9295000</td>
                <td>-1039246000</td>
              </tr>
              <tr>
                <td>6</td>
                <td>Arizona SRS</td>
                <td>0.0</td>
                <td>2020</td>
                <td>1272080000</td>
                <td>1254651000</td>
                <td>2540101000</td>
                <td>127220000</td>
                <td>-3228368000</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>-52949000</td>
                <td>-242252000</td>
                <td>-26845000</td>
                <td>-3551867000</td>
              </tr>
            </table>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[9]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="o">--</span> <span class="p">(</span><span class="n">Panel</span><span class="p">)</span> <span class="n">Asset</span> <span class="n">Allocation</span> <span class="n">Mix</span>

<span class="n">SELECT</span> <span class="n">ppd_id</span><span class="p">,</span> <span class="s2">&quot;PlanName&quot;</span><span class="p">,</span> <span class="s2">&quot;PlanClosed&quot;</span><span class="p">,</span>
<span class="n">cast</span><span class="p">(</span><span class="n">fy</span> <span class="k">as</span> <span class="nb">int</span><span class="p">),</span> 
<span class="s2">&quot;OtherTotal_Actl&quot;</span><span class="p">,</span> <span class="s2">&quot;AltMiscTotal_Actl&quot;</span><span class="p">,</span> <span class="s2">&quot;CashTotal_Actl&quot;</span><span class="p">,</span>
<span class="s2">&quot;COMDTotal_Actl&quot;</span><span class="p">,</span> <span class="s2">&quot;HFTotal_Actl&quot;</span><span class="p">,</span> <span class="s2">&quot;PETotal_Actl&quot;</span><span class="p">,</span> <span class="s2">&quot;RETotal_Actl&quot;</span><span class="p">,</span> <span class="s2">&quot;FITotal_Actl&quot;</span><span class="p">,</span> <span class="s2">&quot;EQTotal_Actl&quot;</span>
<span class="n">FROM</span> <span class="n">public_pensions</span>
<span class="n">WHERE</span> <span class="s2">&quot;PlanClosed&quot;</span> <span class="o">=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">fy</span> <span class="o">=</span> <span class="mi">2021</span> <span class="ow">and</span> <span class="n">ppd_id</span> <span class="o">!=</span> <span class="mi">186</span>
<span class="n">ORDER</span> <span class="n">BY</span> <span class="n">ppd_id</span><span class="p">,</span> <span class="n">fy</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child">

          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



          <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
            (404 row(s) affected)
          </div>

        </div>
        <div class="jp-OutputArea-child">

          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



          <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
            Displaying Top 10 rows.
          </div>

        </div>
        <div class="jp-OutputArea-child">

          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



          <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
            Total execution time: 00:00:00.047
          </div>

        </div>
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[9]:</div>



          <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult"
            data-mime-type="text/html">
            <table>
              <tr>
                <th>ppd_id</th>
                <th>PlanName</th>
                <th>PlanClosed</th>
                <th>fy</th>
                <th>OtherTotal_Actl</th>
                <th>AltMiscTotal_Actl</th>
                <th>CashTotal_Actl</th>
                <th>COMDTotal_Actl</th>
                <th>HFTotal_Actl</th>
                <th>PETotal_Actl</th>
                <th>RETotal_Actl</th>
                <th>FITotal_Actl</th>
                <th>EQTotal_Actl</th>
              </tr>
              <tr>
                <td>1</td>
                <td>Alabama ERS</td>
                <td>0.0</td>
                <td>2021</td>
                <td>0.0</td>
                <td>0.0</td>
                <td>0.0</td>
                <td>0.0</td>
                <td>0.0</td>
                <td>0.0</td>
                <td>0.0</td>
                <td>0.2727</td>
                <td>0.7273</td>
              </tr>
              <tr>
                <td>1</td>
                <td>Alabama ERS</td>
                <td>0.0</td>
                <td>2022</td>
                <td>0.0</td>
                <td>0.0</td>
                <td>0.0</td>
                <td>0.0</td>
                <td>0.0</td>
                <td>0.0</td>
                <td>0.0</td>
                <td>0.30319</td>
                <td>0.69681</td>
              </tr>
              <tr>
                <td>2</td>
                <td>Alabama Teachers</td>
                <td>0.0</td>
                <td>2021</td>
                <td>0.0</td>
                <td>0.0</td>
                <td>0.0</td>
                <td>0.0</td>
                <td>0.0</td>
                <td>0.0</td>
                <td>0.0</td>
                <td>0.26898</td>
                <td>0.73102</td>
              </tr>
              <tr>
                <td>2</td>
                <td>Alabama Teachers</td>
                <td>0.0</td>
                <td>2022</td>
                <td>0.0</td>
                <td>0.0</td>
                <td>0.0</td>
                <td>0.0</td>
                <td>0.0</td>
                <td>0.0</td>
                <td>0.0</td>
                <td>0.2964</td>
                <td>0.7036</td>
              </tr>
              <tr>
                <td>5</td>
                <td>Arizona Public Safety</td>
                <td>0.0</td>
                <td>2021</td>
                <td>0.0</td>
                <td>0.0056</td>
                <td>0.1045</td>
                <td>0.0332</td>
                <td>0.2059</td>
                <td>0.2555</td>
                <td>0.0</td>
                <td>0.0397</td>
                <td>0.3556</td>
              </tr>
              <tr>
                <td>5</td>
                <td>Arizona Public Safety</td>
                <td>0.0</td>
                <td>2022</td>
                <td>0.0</td>
                <td>0.0057</td>
                <td>0.1572</td>
                <td>0.0299</td>
                <td>0.204</td>
                <td>0.2372</td>
                <td>0.0</td>
                <td>0.0323</td>
                <td>0.3337</td>
              </tr>
              <tr>
                <td>6</td>
                <td>Arizona SRS</td>
                <td>0.0</td>
                <td>2021</td>
                <td>0.0</td>
                <td>0.0</td>
                <td>0.02</td>
                <td>0.0</td>
                <td>0.0</td>
                <td>0.262</td>
                <td>0.158</td>
                <td>0.134</td>
                <td>0.426</td>
              </tr>
              <tr>
                <td>6</td>
                <td>Arizona SRS</td>
                <td>0.0</td>
                <td>2022</td>
                <td>0.0</td>
                <td>0.0</td>
                <td>0.016</td>
                <td>0.0</td>
                <td>0.0</td>
                <td>0.127</td>
                <td>0.198</td>
                <td>0.304</td>
                <td>0.355</td>
              </tr>
              <tr>
                <td>7</td>
                <td>Arkansas PERS</td>
                <td>0.0</td>
                <td>2021</td>
                <td>0.0</td>
                <td>0.0</td>
                <td>0.0</td>
                <td>0.0</td>
                <td>0.04523</td>
                <td>0.0</td>
                <td>0.11256</td>
                <td>0.14874</td>
                <td>0.69347</td>
              </tr>
              <tr>
                <td>7</td>
                <td>Arkansas PERS</td>
                <td>0.0</td>
                <td>2022</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>NULL</td>
                <td>NULL</td>
              </tr>
            </table>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[10]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="o">--</span> <span class="p">(</span><span class="n">Panel</span><span class="p">)</span> <span class="n">Investment</span> <span class="n">Income</span>

<span class="n">SELECT</span> <span class="n">ppd_id</span><span class="p">,</span> <span class="s2">&quot;PlanName&quot;</span><span class="p">,</span> <span class="s2">&quot;PlanClosed&quot;</span><span class="p">,</span>
<span class="n">cast</span><span class="p">(</span><span class="n">fy</span> <span class="k">as</span> <span class="nb">int</span><span class="p">),</span> 
<span class="n">cast</span><span class="p">(</span><span class="s2">&quot;FairValueChange_tot&quot;</span> <span class="o">*</span> <span class="mi">1000</span> <span class="k">as</span> <span class="n">bigint</span><span class="p">)</span> <span class="k">as</span> <span class="s2">&quot;FairValueChange_tot&quot;</span>
<span class="n">FROM</span> <span class="n">public_pensions</span>
<span class="n">WHERE</span> <span class="s2">&quot;PlanClosed&quot;</span> <span class="o">=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">fy</span> <span class="o">&lt;=</span><span class="mi">2022</span> <span class="ow">and</span> <span class="n">fy</span> <span class="o">&gt;=</span> <span class="mi">2013</span> <span class="ow">and</span> <span class="n">ppd_id</span> <span class="o">!=</span> <span class="mi">186</span>
<span class="n">ORDER</span> <span class="n">BY</span> <span class="n">ppd_id</span><span class="p">,</span> <span class="n">fy</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child">

          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



          <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
            (2020 row(s) affected)
          </div>

        </div>
        <div class="jp-OutputArea-child">

          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



          <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
            Displaying Top 10 rows.
          </div>

        </div>
        <div class="jp-OutputArea-child">

          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



          <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
            Total execution time: 00:00:00.089
          </div>

        </div>
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[10]:</div>



          <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult"
            data-mime-type="text/html">
            <table>
              <tr>
                <th>ppd_id</th>
                <th>PlanName</th>
                <th>PlanClosed</th>
                <th>fy</th>
                <th>FairValueChange_tot</th>
              </tr>
              <tr>
                <td>1</td>
                <td>Alabama ERS</td>
                <td>0.0</td>
                <td>2013</td>
                <td>984714000</td>
              </tr>
              <tr>
                <td>1</td>
                <td>Alabama ERS</td>
                <td>0.0</td>
                <td>2014</td>
                <td>888303000</td>
              </tr>
              <tr>
                <td>1</td>
                <td>Alabama ERS</td>
                <td>0.0</td>
                <td>2015</td>
                <td>-186154000</td>
              </tr>
              <tr>
                <td>1</td>
                <td>Alabama ERS</td>
                <td>0.0</td>
                <td>2016</td>
                <td>753836000</td>
              </tr>
              <tr>
                <td>1</td>
                <td>Alabama ERS</td>
                <td>0.0</td>
                <td>2017</td>
                <td>1098859000</td>
              </tr>
              <tr>
                <td>1</td>
                <td>Alabama ERS</td>
                <td>0.0</td>
                <td>2018</td>
                <td>775132000</td>
              </tr>
              <tr>
                <td>1</td>
                <td>Alabama ERS</td>
                <td>0.0</td>
                <td>2019</td>
                <td>30092000</td>
              </tr>
              <tr>
                <td>1</td>
                <td>Alabama ERS</td>
                <td>0.0</td>
                <td>2020</td>
                <td>425632000</td>
              </tr>
              <tr>
                <td>1</td>
                <td>Alabama ERS</td>
                <td>0.0</td>
                <td>2021</td>
                <td>2558276000</td>
              </tr>
              <tr>
                <td>1</td>
                <td>Alabama ERS</td>
                <td>0.0</td>
                <td>2022</td>
                <td>-2274633000</td>
              </tr>
            </table>
          </div>

        </div>

      </div>

    </div>

  </div>
</body>







</html>