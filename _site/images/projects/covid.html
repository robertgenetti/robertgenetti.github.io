<!DOCTYPE html>
<html>
<head><meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>covid</title><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>

<!-- Custom stylesheet, it must be in the same directory as the html file -->
<link rel="stylesheet" href="custom.css">

<!-- Load mathjax -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML-full,Safe"> </script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    init_mathjax = function() {
        if (window.MathJax) {
        // MathJax loaded
            MathJax.Hub.Config({
                TeX: {
                    equationNumbers: {
                    autoNumber: "AMS",
                    useLabelIds: true
                    }
                },
                tex2jax: {
                    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                    processEscapes: true,
                    processEnvironments: true
                },
                displayAlign: 'center',
                CommonHTML: {
                    linebreaks: {
                    automatic: true
                    }
                }
            });

            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        }
    }
    init_mathjax();
    </script>
    <!-- End of mathjax configuration --></head>
<body class="jp-Notebook" data-jp-theme-light="true" data-jp-theme-name="JupyterLab Light">
<div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[1]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-sql"><pre><span></span><span class="c1">-- check the total rows in data table</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="k">from</span><span class="w"> </span><span class="ss">"OwidCovid"</span><span class="w"></span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
(1 row(s) affected)
</div>

</div>
<div class="jp-OutputArea-child">
    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
Total execution time: 00:00:01.208
</div>

</div>
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[1]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html">
<table><tr><th>count</th></tr><tr><td>214706</td></tr></table>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<h1 id="Covid-19-Dashboard-Project">Covid-19 Dashboard Project<a class="anchor-link" href="#Covid-19-Dashboard-Project">&#182;</a></h1><h2 id="Python,-SQL-and-Tableau:-Data-Extraction,-Key-Metrics,-Dashboard">Python, SQL and Tableau: Data Extraction, Key Metrics, Dashboard<a class="anchor-link" href="#Python,-SQL-and-Tableau:-Data-Extraction,-Key-Metrics,-Dashboard">&#182;</a></h2><h3 id="Here-are-a-few-key-metrics-using-SQL">Here are a few key metrics using SQL<a class="anchor-link" href="#Here-are-a-few-key-metrics-using-SQL">&#182;</a></h3><ul>
<li>(Panel)Total cases vs Total deaths</li>
<li>(Panel) Percentage of population got Covid-19</li>
<li>(Cross-sectional) Highest infection rate compared to population</li>
<li><mark>(Cross-sectional) Countries with the highest death count</mark></li>
<li>(Cross-sectional) Continents with the highest death count</li>
<li><mark>(Time Series) Global Covid-19 cases, deaths, case fatality rate</mark></li>
<li><mark>(Cross-sectional) Vaccination rates [ partial , full , booster ] by country</mark></li>
<li><mark>(Cross-sectional) Vaccination rates [ partial , full , booster ] by income group</mark></li>
</ul>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[1]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-sql"><pre><span></span><span class="c1">-- Total cases vs Total deaths</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">iso_code</span><span class="p">,</span><span class="w"> </span><span class="k">location</span><span class="p">,</span><span class="w"> </span><span class="nb">date</span><span class="p">::</span><span class="nb">DATE</span><span class="p">,</span><span class="w"> </span><span class="n">total_cases</span><span class="p">::</span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="n">total_deaths</span><span class="p">::</span><span class="nb">INT</span><span class="p">,</span><span class="w"></span>
<span class="n">ROUND</span><span class="p">((</span><span class="n">total_deaths</span><span class="o">/</span><span class="k">nullif</span><span class="p">(</span><span class="n">total_cases</span><span class="p">,</span><span class="mi">0</span><span class="p">))::</span><span class="nb">NUMERIC</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">DeathPercentage</span><span class="w"></span>
<span class="k">FROM</span><span class="w"> </span><span class="ss">"OwidCovid"</span><span class="w"></span>
<span class="k">where</span><span class="w"> </span><span class="n">iso_code</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">'OWID%'</span><span class="w"></span>
<span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="w"></span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
(202881 row(s) affected)
</div>

</div>
<div class="jp-OutputArea-child">
    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
Displaying Top 10 rows.
</div>

</div>
<div class="jp-OutputArea-child">
    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
Total execution time: 00:00:12.366
</div>

</div>
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[1]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html">
<table><tr><th>iso_code</th><th>location</th><th>date</th><th>total_cases</th><th>total_deaths</th><th>deathpercentage</th></tr><tr><td>AFG</td><td>Afghanistan</td><td>2020-02-24</td><td>5</td><td>0</td><td>0.00</td></tr><tr><td>AFG</td><td>Afghanistan</td><td>2020-02-25</td><td>5</td><td>0</td><td>0.00</td></tr><tr><td>AFG</td><td>Afghanistan</td><td>2020-02-26</td><td>5</td><td>0</td><td>0.00</td></tr><tr><td>AFG</td><td>Afghanistan</td><td>2020-02-27</td><td>5</td><td>0</td><td>0.00</td></tr><tr><td>AFG</td><td>Afghanistan</td><td>2020-02-28</td><td>5</td><td>0</td><td>0.00</td></tr><tr><td>AFG</td><td>Afghanistan</td><td>2020-02-29</td><td>5</td><td>0</td><td>0.00</td></tr><tr><td>AFG</td><td>Afghanistan</td><td>2020-03-01</td><td>5</td><td>0</td><td>0.00</td></tr><tr><td>AFG</td><td>Afghanistan</td><td>2020-03-02</td><td>5</td><td>0</td><td>0.00</td></tr><tr><td>AFG</td><td>Afghanistan</td><td>2020-03-03</td><td>5</td><td>0</td><td>0.00</td></tr><tr><td>AFG</td><td>Afghanistan</td><td>2020-03-04</td><td>5</td><td>0</td><td>0.00</td></tr></table>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[2]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-sql"><pre><span></span><span class="c1">-- Percentage of population got Covid-19</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">iso_code</span><span class="p">,</span><span class="w"> </span><span class="k">location</span><span class="p">,</span><span class="w"> </span><span class="nb">date</span><span class="p">::</span><span class="nb">DATE</span><span class="p">,</span><span class="w"> </span><span class="n">total_cases</span><span class="p">::</span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="n">population</span><span class="p">::</span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span>
<span class="n">ROUND</span><span class="p">((</span><span class="n">total_cases</span><span class="o">/</span><span class="n">population</span><span class="p">)::</span><span class="nb">NUMERIC</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">InfectionPercentage</span><span class="w"></span>
<span class="k">FROM</span><span class="w"> </span><span class="ss">"OwidCovid"</span><span class="w"></span>
<span class="k">where</span><span class="w"> </span><span class="n">iso_code</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">'OWID%'</span><span class="w"></span>
<span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="w"></span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
(202881 row(s) affected)
</div>

</div>
<div class="jp-OutputArea-child">
    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
Displaying Top 10 rows.
</div>

</div>
<div class="jp-OutputArea-child">
    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
Total execution time: 00:00:11.339
</div>

</div>
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[2]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html">
<table><tr><th>iso_code</th><th>location</th><th>date</th><th>total_cases</th><th>population</th><th>infectionpercentage</th></tr><tr><td>AFG</td><td>Afghanistan</td><td>2020-02-24</td><td>5</td><td>40099462</td><td>0.00</td></tr><tr><td>AFG</td><td>Afghanistan</td><td>2020-02-25</td><td>5</td><td>40099462</td><td>0.00</td></tr><tr><td>AFG</td><td>Afghanistan</td><td>2020-02-26</td><td>5</td><td>40099462</td><td>0.00</td></tr><tr><td>AFG</td><td>Afghanistan</td><td>2020-02-27</td><td>5</td><td>40099462</td><td>0.00</td></tr><tr><td>AFG</td><td>Afghanistan</td><td>2020-02-28</td><td>5</td><td>40099462</td><td>0.00</td></tr><tr><td>AFG</td><td>Afghanistan</td><td>2020-02-29</td><td>5</td><td>40099462</td><td>0.00</td></tr><tr><td>AFG</td><td>Afghanistan</td><td>2020-03-01</td><td>5</td><td>40099462</td><td>0.00</td></tr><tr><td>AFG</td><td>Afghanistan</td><td>2020-03-02</td><td>5</td><td>40099462</td><td>0.00</td></tr><tr><td>AFG</td><td>Afghanistan</td><td>2020-03-03</td><td>5</td><td>40099462</td><td>0.00</td></tr><tr><td>AFG</td><td>Afghanistan</td><td>2020-03-04</td><td>5</td><td>40099462</td><td>0.00</td></tr></table>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[3]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-sql"><pre><span></span><span class="c1">-- Highest infection rate compared to population</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">iso_code</span><span class="p">,</span><span class="w"> </span><span class="k">location</span><span class="p">,</span><span class="nb">date</span><span class="p">::</span><span class="nb">DATE</span><span class="p">,</span><span class="w"> </span><span class="k">max</span><span class="p">(</span><span class="n">total_cases</span><span class="p">)::</span><span class="nb">INT</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">highestinfectioncount</span><span class="p">,</span><span class="w"> </span><span class="n">population</span><span class="p">::</span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span>
<span class="n">ROUND</span><span class="p">(</span><span class="k">max</span><span class="p">(</span><span class="n">total_cases</span><span class="o">/</span><span class="n">population</span><span class="p">)::</span><span class="nb">NUMERIC</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">percentagepopinfected</span><span class="w"></span>
<span class="k">FROM</span><span class="w"> </span><span class="ss">"OwidCovid"</span><span class="w"></span>
<span class="k">where</span><span class="w"> </span><span class="n">iso_code</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">'OWID%'</span><span class="w"></span>
<span class="k">and</span><span class="w"> </span><span class="nb">date</span><span class="o">=</span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="k">max</span><span class="p">(</span><span class="nb">date</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="ss">"OwidCovid"</span><span class="p">)</span><span class="w"></span>
<span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">iso_code</span><span class="p">,</span><span class="w"> </span><span class="k">location</span><span class="p">,</span><span class="w"> </span><span class="n">population</span><span class="p">,</span><span class="w"> </span><span class="nb">date</span><span class="w"></span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">percentagepopinfected</span><span class="w"> </span><span class="k">desc</span><span class="w"></span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
(217 row(s) affected)
</div>

</div>
<div class="jp-OutputArea-child">
    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
Displaying Top 10 rows.
</div>

</div>
<div class="jp-OutputArea-child">
    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
Total execution time: 00:00:00.222
</div>

</div>
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[3]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html">
<table><tr><th>iso_code</th><th>location</th><th>date</th><th>highestinfectioncount</th><th>population</th><th>percentagepopinfected</th></tr><tr><td>FRO</td><td>Faeroe Islands</td><td>2022-09-14</td><td>34658</td><td>52888</td><td>65.53</td></tr><tr><td>CYP</td><td>Cyprus</td><td>2022-09-14</td><td>579899</td><td>896007</td><td>64.72</td></tr><tr><td>GIB</td><td>Gibraltar</td><td>2022-09-14</td><td>20069</td><td>32670</td><td>61.43</td></tr><tr><td>SMR</td><td>San Marino</td><td>2022-09-14</td><td>20540</td><td>33746</td><td>60.87</td></tr><tr><td>AND</td><td>Andorra</td><td>2022-09-14</td><td>46147</td><td>79034</td><td>58.39</td></tr><tr><td>DNK</td><td>Denmark</td><td>2022-09-14</td><td>3283706</td><td>5854240</td><td>56.09</td></tr><tr><td>AUT</td><td>Austria</td><td>2022-09-14</td><td>4996567</td><td>8922082</td><td>56.00</td></tr><tr><td>ISL</td><td>Iceland</td><td>2022-09-14</td><td>205284</td><td>370335</td><td>55.43</td></tr><tr><td>SVN</td><td>Slovenia</td><td>2022-09-14</td><td>1149364</td><td>2119410</td><td>54.23</td></tr><tr><td>SPM</td><td>Saint Pierre and Miquelon</td><td>2022-09-14</td><td>3166</td><td>5883</td><td>53.82</td></tr></table>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[4]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-sql"><pre><span></span><span class="c1">-- Countries with the highest death count</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">iso_code</span><span class="p">,</span><span class="w"> </span><span class="k">location</span><span class="p">,</span><span class="w"> </span><span class="k">max</span><span class="p">(</span><span class="n">total_deaths</span><span class="p">)::</span><span class="nb">INT</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">deathcount</span><span class="w"></span>
<span class="k">FROM</span><span class="w"> </span><span class="ss">"OwidCovid"</span><span class="w"></span>
<span class="k">where</span><span class="w"> </span><span class="n">iso_code</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">'OWID%'</span><span class="w"></span>
<span class="k">and</span><span class="w"> </span><span class="nb">date</span><span class="o">=</span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="k">max</span><span class="p">(</span><span class="nb">date</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="ss">"OwidCovid"</span><span class="p">)</span><span class="w"></span>
<span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">iso_code</span><span class="p">,</span><span class="w"> </span><span class="k">location</span><span class="w"></span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">deathcount</span><span class="w"> </span><span class="k">desc</span><span class="w"></span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
(217 row(s) affected)
</div>

</div>
<div class="jp-OutputArea-child">
    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
Displaying Top 10 rows.
</div>

</div>
<div class="jp-OutputArea-child">
    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
Total execution time: 00:00:00.125
</div>

</div>
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[4]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html">
<table><tr><th>iso_code</th><th>location</th><th>deathcount</th></tr><tr><td>USA</td><td>United States</td><td>1052214</td></tr><tr><td>BRA</td><td>Brazil</td><td>685121</td></tr><tr><td>IND</td><td>India</td><td>528250</td></tr><tr><td>RUS</td><td>Russia</td><td>377823</td></tr><tr><td>MEX</td><td>Mexico</td><td>329767</td></tr><tr><td>PER</td><td>Peru</td><td>216202</td></tr><tr><td>GBR</td><td>United Kingdom</td><td>205717</td></tr><tr><td>ITA</td><td>Italy</td><td>176404</td></tr><tr><td>IDN</td><td>Indonesia</td><td>157828</td></tr><tr><td>FRA</td><td>France</td><td>154680</td></tr></table>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[5]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-sql"><pre><span></span><span class="c1">-- Continents with the highest death count</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">iso_code</span><span class="p">,</span><span class="w"> </span><span class="k">location</span><span class="p">,</span><span class="w"> </span><span class="k">max</span><span class="p">(</span><span class="n">total_deaths</span><span class="p">)::</span><span class="nb">INT</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">deathcount</span><span class="w"></span>
<span class="k">FROM</span><span class="w"> </span><span class="ss">"OwidCovid"</span><span class="w"></span>
<span class="k">where</span><span class="w"> </span><span class="nb">date</span><span class="o">=</span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="k">max</span><span class="p">(</span><span class="nb">date</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="ss">"OwidCovid"</span><span class="p">)</span><span class="w"></span>
<span class="k">and</span><span class="w"> </span><span class="n">continent</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">null</span><span class="w"> </span>
<span class="k">and</span><span class="w"> </span><span class="n">iso_code</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="s1">'OWID_UMC'</span><span class="p">,</span><span class="s1">'OWID_HIC'</span><span class="p">,</span><span class="s1">'OWID_LMC'</span><span class="p">,</span><span class="s1">'OWID_LIC'</span><span class="p">)</span><span class="w"></span>
<span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">iso_code</span><span class="p">,</span><span class="w"> </span><span class="k">location</span><span class="w"></span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">deathcount</span><span class="w"> </span><span class="k">desc</span><span class="w"></span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
(9 row(s) affected)
</div>

</div>
<div class="jp-OutputArea-child">
    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
Total execution time: 00:00:00.113
</div>

</div>
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[5]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html">
<table><tr><th>iso_code</th><th>location</th><th>deathcount</th></tr><tr><td>OWID_WRL</td><td>World</td><td>6519788</td></tr><tr><td>OWID_EUR</td><td>Europe</td><td>1932905</td></tr><tr><td>OWID_NAM</td><td>North America</td><td>1504369</td></tr><tr><td>OWID_ASI</td><td>Asia</td><td>1479397</td></tr><tr><td>OWID_SAM</td><td>South America</td><td>1327251</td></tr><tr><td>OWID_EUN</td><td>European Union</td><td>1142803</td></tr><tr><td>OWID_AFR</td><td>Africa</td><td>256644</td></tr><tr><td>OWID_OCE</td><td>Oceania</td><td>19207</td></tr><tr><td>OWID_INT</td><td>International</td><td>15</td></tr></table>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[6]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-sql"><pre><span></span><span class="c1">-- Global Covid-19 cases, deaths, case fatality rate</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">location</span><span class="p">,</span><span class="w"> </span><span class="nb">date</span><span class="p">::</span><span class="nb">date</span><span class="p">,</span><span class="w"> </span><span class="n">new_cases</span><span class="p">::</span><span class="nb">int</span><span class="p">,</span><span class="w"> </span><span class="n">new_deaths</span><span class="p">::</span><span class="nb">int</span><span class="p">,</span><span class="w"></span>
<span class="n">round</span><span class="p">((</span><span class="n">new_deaths</span><span class="o">/</span><span class="k">nullif</span><span class="p">(</span><span class="n">new_cases</span><span class="p">,</span><span class="mi">0</span><span class="p">))::</span><span class="nb">numeric</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">deathpercentage</span><span class="w"></span>
<span class="k">FROM</span><span class="w"> </span><span class="ss">"OwidCovid"</span><span class="w"></span>
<span class="k">where</span><span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'World'</span><span class="w"></span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="nb">date</span><span class="w"></span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
(967 row(s) affected)
</div>

</div>
<div class="jp-OutputArea-child">
    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
Displaying Top 10 rows.
</div>

</div>
<div class="jp-OutputArea-child">
    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
Total execution time: 00:00:00.129
</div>

</div>
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[6]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html">
<table><tr><th>location</th><th>date</th><th>new_cases</th><th>new_deaths</th><th>deathpercentage</th></tr><tr><td>World</td><td>2020-01-22</td><td>0</td><td>0</td><td>NULL</td></tr><tr><td>World</td><td>2020-01-23</td><td>100</td><td>1</td><td>1.00</td></tr><tr><td>World</td><td>2020-01-24</td><td>287</td><td>8</td><td>2.79</td></tr><tr><td>World</td><td>2020-01-25</td><td>493</td><td>16</td><td>3.25</td></tr><tr><td>World</td><td>2020-01-26</td><td>683</td><td>14</td><td>2.05</td></tr><tr><td>World</td><td>2020-01-27</td><td>809</td><td>26</td><td>3.21</td></tr><tr><td>World</td><td>2020-01-28</td><td>2651</td><td>49</td><td>1.85</td></tr><tr><td>World</td><td>2020-01-29</td><td>589</td><td>2</td><td>0.34</td></tr><tr><td>World</td><td>2020-01-30</td><td>2068</td><td>39</td><td>1.89</td></tr><tr><td>World</td><td>2020-01-31</td><td>1690</td><td>42</td><td>2.49</td></tr></table>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[7]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-sql"><pre><span></span><span class="c1">-- Vaccination rates ( partial / full / booster ) by country</span>
<span class="k">with</span><span class="w"> </span><span class="n">popvsvac</span><span class="w"> </span><span class="p">(</span><span class="n">iso_code</span><span class="p">,</span><span class="w"> </span><span class="k">location</span><span class="p">,</span><span class="w"> </span><span class="n">population</span><span class="p">,</span><span class="w"></span>
<span class="n">part_vacc</span><span class="p">,</span><span class="n">full_vacc</span><span class="p">,</span><span class="n">booster</span><span class="p">)</span><span class="w"></span>
<span class="k">as</span><span class="w"></span>

<span class="p">(</span><span class="k">select</span><span class="w"> </span><span class="n">iso_code</span><span class="p">,</span><span class="w"> </span><span class="k">location</span><span class="p">,</span><span class="w"> </span><span class="n">population</span><span class="p">,</span><span class="w"> </span>
<span class="k">max</span><span class="p">(</span><span class="n">people_vaccinated</span><span class="p">),</span><span class="w"></span>
<span class="k">max</span><span class="p">(</span><span class="n">people_fully_vaccinated</span><span class="p">),</span><span class="w"></span>
<span class="k">max</span><span class="p">(</span><span class="n">total_boosters</span><span class="p">)</span><span class="w"> </span>
<span class="k">from</span><span class="w"> </span><span class="ss">"OwidCovid"</span><span class="w"></span>
<span class="k">where</span><span class="w"> </span><span class="n">iso_code</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">'OWID%'</span><span class="w"></span>
<span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">iso_code</span><span class="p">,</span><span class="w"> </span><span class="k">location</span><span class="p">,</span><span class="w"> </span><span class="n">population</span><span class="p">)</span><span class="w"></span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">iso_code</span><span class="p">,</span><span class="w"> </span><span class="k">location</span><span class="p">,</span><span class="w"></span>
<span class="n">round</span><span class="p">((</span><span class="n">part_vacc</span><span class="o">/</span><span class="n">population</span><span class="p">)::</span><span class="nb">numeric</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="ss">"Partially Vaccinated"</span><span class="p">,</span><span class="w"></span>
<span class="n">round</span><span class="p">((</span><span class="n">full_vacc</span><span class="o">/</span><span class="n">population</span><span class="p">)::</span><span class="nb">numeric</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="ss">"Fully Vaccinated"</span><span class="p">,</span><span class="w"></span>
<span class="n">round</span><span class="p">((</span><span class="n">booster</span><span class="o">/</span><span class="n">population</span><span class="p">)::</span><span class="nb">numeric</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="ss">"Booster"</span><span class="w"></span>
<span class="k">FROM</span><span class="w"> </span><span class="n">popvsvac</span><span class="w"></span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="k">desc</span><span class="w"></span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
(229 row(s) affected)
</div>

</div>
<div class="jp-OutputArea-child">
    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
Displaying Top 10 rows.
</div>

</div>
<div class="jp-OutputArea-child">
    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
Total execution time: 00:00:00.196
</div>

</div>
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[7]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html">
<table><tr><th>iso_code</th><th>location</th><th>Partially Vaccinated</th><th>Fully Vaccinated</th><th>Booster</th></tr><tr><td>GIB</td><td>Gibraltar</td><td>128.78</td><td>126.79</td><td>111.29</td></tr><tr><td>ARE</td><td>United Arab Emirates</td><td>106.68</td><td>104.56</td><td>54.87</td></tr><tr><td>QAT</td><td>Qatar</td><td>103.63</td><td>103.63</td><td>69.46</td></tr><tr><td>PCN</td><td>Pitcairn</td><td>100.00</td><td>100.00</td><td>48.94</td></tr><tr><td>BRN</td><td>Brunei</td><td>100.91</td><td>99.78</td><td>74.86</td></tr><tr><td>WSM</td><td>Samoa</td><td>105.32</td><td>96.66</td><td>34.23</td></tr><tr><td>SGP</td><td>Singapore</td><td>92.13</td><td>91.77</td><td>78.80</td></tr><tr><td>CHL</td><td>Chile</td><td>92.67</td><td>90.65</td><td>138.73</td></tr><tr><td>MLT</td><td>Malta</td><td>90.71</td><td>89.36</td><td>79.85</td></tr><tr><td>CHN</td><td>China</td><td>91.37</td><td>89.11</td><td>56.51</td></tr></table>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[8]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-sql"><pre><span></span><span class="c1">-- Vaccination rates ( partial / full / booster ) by income group</span>
<span class="k">with</span><span class="w"> </span><span class="n">popvsvac</span><span class="w"> </span><span class="p">(</span><span class="n">iso_code</span><span class="p">,</span><span class="w"> </span><span class="k">location</span><span class="p">,</span><span class="w"> </span><span class="n">population</span><span class="p">,</span><span class="w"></span>
<span class="n">part_vacc</span><span class="p">,</span><span class="n">full_vacc</span><span class="p">,</span><span class="n">booster</span><span class="p">)</span><span class="w"></span>
<span class="k">as</span><span class="w"></span>

<span class="p">(</span><span class="k">select</span><span class="w"> </span><span class="n">iso_code</span><span class="p">,</span><span class="w"> </span><span class="k">location</span><span class="p">,</span><span class="w"> </span><span class="n">population</span><span class="p">,</span><span class="w"> </span>
<span class="k">max</span><span class="p">(</span><span class="n">people_vaccinated</span><span class="p">),</span><span class="w"></span>
<span class="k">max</span><span class="p">(</span><span class="n">people_fully_vaccinated</span><span class="p">),</span><span class="w"></span>
<span class="k">max</span><span class="p">(</span><span class="n">total_boosters</span><span class="p">)</span><span class="w"> </span>
<span class="k">from</span><span class="w"> </span><span class="ss">"OwidCovid"</span><span class="w"></span>
<span class="k">where</span><span class="w"> </span><span class="n">iso_code</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">'OWID%'</span><span class="w"></span>
<span class="k">and</span><span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="s1">'High income'</span><span class="p">,</span><span class="s1">'Upper middle income'</span><span class="p">,</span><span class="s1">'Lower middle income'</span><span class="p">,</span><span class="s1">'Low income'</span><span class="p">)</span><span class="w"></span>
<span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">iso_code</span><span class="p">,</span><span class="w"> </span><span class="k">location</span><span class="p">,</span><span class="w"> </span><span class="n">population</span><span class="p">)</span><span class="w"></span>

<span class="k">SELECT</span><span class="w"> </span><span class="k">location</span><span class="p">,</span><span class="w"></span>
<span class="n">round</span><span class="p">((</span><span class="n">part_vacc</span><span class="o">/</span><span class="n">population</span><span class="p">)::</span><span class="nb">numeric</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="ss">"Partially Vaccinated"</span><span class="p">,</span><span class="w"></span>
<span class="n">round</span><span class="p">((</span><span class="n">full_vacc</span><span class="o">/</span><span class="n">population</span><span class="p">)::</span><span class="nb">numeric</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="ss">"Fully Vaccinated"</span><span class="p">,</span><span class="w"></span>
<span class="n">round</span><span class="p">((</span><span class="n">booster</span><span class="o">/</span><span class="n">population</span><span class="p">)::</span><span class="nb">numeric</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="ss">"Booster"</span><span class="w"></span>
<span class="k">FROM</span><span class="w"> </span><span class="n">popvsvac</span><span class="w"></span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
(4 row(s) affected)
</div>

</div>
<div class="jp-OutputArea-child">
    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
Total execution time: 00:00:00.069
</div>

</div>
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[8]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html">
<table><tr><th>location</th><th>Partially Vaccinated</th><th>Fully Vaccinated</th><th>Booster</th></tr><tr><td>High income</td><td>79.67</td><td>74.70</td><td>57.78</td></tr><tr><td>Low income</td><td>22.47</td><td>18.36</td><td>1.33</td></tr><tr><td>Lower middle income</td><td>63.51</td><td>56.81</td><td>16.20</td></tr><tr><td>Upper middle income</td><td>83.39</td><td>78.81</td><td>48.21</td></tr></table>
</div>

</div>

</div>

</div>

</div>
</body>







</html>
